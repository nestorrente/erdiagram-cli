CREATE SEQUENCE "USER_SEQ" START WITH 1;
CREATE TABLE "USER" (
    "USER_ID" NUMBER NOT NULL DEFAULT "USER_SEQ".nextval,
    "USERNAME" VARCHAR2(50) NOT NULL,
    "NAME" VARCHAR2(50) NOT NULL,
    "BIRTHDAY" DATE,
    "AVATAR" BLOB,
    "ACTIVE" NUMBER(1, 0) NOT NULL,
    "COUNTRY_ID" NUMBER NOT NULL,
    "ALTERNATIVE_COUNTRY_ID" NUMBER,
    CONSTRAINT "USER_PK" PRIMARY KEY ("USER_ID"),
    CONSTRAINT "USER_USERNAME_UNIQUE" UNIQUE ("USERNAME")
);

CREATE SEQUENCE "COUNTRY_SEQ" START WITH 1;
CREATE TABLE "COUNTRY" (
    "THE_COUNTRY_ID" NUMBER NOT NULL DEFAULT "COUNTRY_SEQ".nextval,
    "CODE" VARCHAR2(5) NOT NULL,
    "NAME" VARCHAR2(100) NOT NULL,
    CONSTRAINT "COUNTRY_PK" PRIMARY KEY ("THE_COUNTRY_ID")
);

CREATE SEQUENCE "PERMISSION_SEQ" START WITH 1;
CREATE TABLE "PERMISSION" (
    "PERMISSION_ID" NUMBER NOT NULL DEFAULT "PERMISSION_SEQ".nextval,
    "CODE" VARCHAR2(30) NOT NULL,
    "DESCRIPTION" VARCHAR2(200) NOT NULL,
    CONSTRAINT "PERMISSION_PK" PRIMARY KEY ("PERMISSION_ID")
);

CREATE SEQUENCE "TREE_SEQ" START WITH 1;
CREATE TABLE "TREE" (
    "TREE_ID" NUMBER NOT NULL DEFAULT "TREE_SEQ".nextval,
    "HEAD_NODE_ID" NUMBER NOT NULL,
    CONSTRAINT "TREE_PK" PRIMARY KEY ("TREE_ID"),
    CONSTRAINT "TREE_HEAD_NODE_ID_UNIQUE" UNIQUE ("HEAD_NODE_ID")
);

CREATE SEQUENCE "TREE_NODE_SEQ" START WITH 1;
CREATE TABLE "TREE_NODE" (
    "TREE_NODE_ID" NUMBER NOT NULL DEFAULT "TREE_NODE_SEQ".nextval,
    "VALUE" NUMBER NOT NULL,
    "PARENT_ID" NUMBER,
    CONSTRAINT "TREE_NODE_PK" PRIMARY KEY ("TREE_NODE_ID")
);

CREATE SEQUENCE "USER_PERMISSION_SEQ" START WITH 1;
CREATE TABLE "USER_PERMISSION" (
    "USER_PERMISSION_ID" NUMBER NOT NULL DEFAULT "USER_PERMISSION_SEQ".nextval,
    "USER_ID" NUMBER NOT NULL,
    "PERMISSION_ID" NUMBER NOT NULL,
    CONSTRAINT "USER_PERMISSION_PK" PRIMARY KEY ("USER_PERMISSION_ID")
);

CREATE SEQUENCE "FOLLOWS_SEQ" START WITH 1;
CREATE TABLE "FOLLOWS" (
    "FOLLOWS_ID" NUMBER NOT NULL DEFAULT "FOLLOWS_SEQ".nextval,
    "FOLLOWER_ID" NUMBER NOT NULL,
    "FOLLOW_ID" NUMBER NOT NULL,
    CONSTRAINT "FOLLOWS_PK" PRIMARY KEY ("FOLLOWS_ID")
);

ALTER TABLE "USER" ADD CONSTRAINT "USER_COUNTRY_ID_FK" FOREIGN KEY ("COUNTRY_ID") REFERENCES "COUNTRY" ("THE_COUNTRY_ID");
ALTER TABLE "USER" ADD CONSTRAINT "USER_ALTERNATIVE_COUNTRY_ID_FK" FOREIGN KEY ("ALTERNATIVE_COUNTRY_ID") REFERENCES "COUNTRY" ("THE_COUNTRY_ID");

ALTER TABLE "TREE" ADD CONSTRAINT "TREE_HEAD_NODE_ID_FK" FOREIGN KEY ("HEAD_NODE_ID") REFERENCES "TREE_NODE" ("TREE_NODE_ID");

ALTER TABLE "TREE_NODE" ADD CONSTRAINT "TREE_NODE_PARENT_ID_FK" FOREIGN KEY ("PARENT_ID") REFERENCES "TREE_NODE" ("TREE_NODE_ID");

ALTER TABLE "USER_PERMISSION" ADD CONSTRAINT "USER_PERMISSION_USER_ID_FK" FOREIGN KEY ("USER_ID") REFERENCES "USER" ("USER_ID");
ALTER TABLE "USER_PERMISSION" ADD CONSTRAINT "USER_PERMISSION_PERMISSION_ID_FK" FOREIGN KEY ("PERMISSION_ID") REFERENCES "PERMISSION" ("PERMISSION_ID");

ALTER TABLE "FOLLOWS" ADD CONSTRAINT "FOLLOWS_FOLLOWER_ID_FK" FOREIGN KEY ("FOLLOWER_ID") REFERENCES "USER" ("USER_ID");
ALTER TABLE "FOLLOWS" ADD CONSTRAINT "FOLLOWS_FOLLOW_ID_FK" FOREIGN KEY ("FOLLOW_ID") REFERENCES "USER" ("USER_ID");
